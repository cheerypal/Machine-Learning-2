C:\Users\euang\AppData\Local\Programs\Python\Python38\python.exe C:/Users/euang/Documents/Year4/supervised-amaan-learning/Decision_Trees/main.py

Running J48 ....

Cross Validation started ....
Start confusion matrix ....
Confusion Matrix:
 [[ 43  78  48  11  13   3   0   2  10   2]
 [ 88 790 617 168 357  20  30  40  64  46]
 [ 48 611 688 250 430  26  38  22  85  52]
 [ 13 197 249 461 373   8  32  20  20  37]
 [ 21 341 434 342 688  40  32  29  37  16]
 [  3  30  32  19  21  58   6  12  22   7]
 [  2  32  44  61  75   7  84  12  24  19]
 [  7  25  49  23  23  12  17  41  31  12]
 [  7  86  75  50  83  36  26  33 111  33]
 [  5  40  44  35  27   0  13  20  25  61]]

               precision    recall  f1-score   support

           0       0.18      0.20      0.19       210
           1       0.35      0.36      0.36      2220
           2       0.30      0.31      0.30      2250
           3       0.32      0.33      0.33      1410
           4       0.33      0.35      0.34      1980
           5       0.28      0.28      0.28       210
           6       0.30      0.23      0.26       360
           7       0.18      0.17      0.17       240
           8       0.26      0.21      0.23       540
           9       0.21      0.23      0.22       270

    accuracy                           0.31      9690
   macro avg       0.27      0.27      0.27      9690
weighted avg       0.31      0.31      0.31      9690


    Average tpr  Average fpr
0     0.659845     0.598413
1     0.602410     0.548048
2     0.595341     0.564741
3     0.628060     0.557683
4     0.606053     0.550842
5     0.661322     0.574603
6     0.659736     0.588889
7     0.659965     0.609722
8     0.655082     0.598148
9     0.658740     0.591358

    ROC Area
0  0.592149
1  0.581542
2  0.545900
3  0.605565
4  0.582816
5  0.630078
6  0.606270
7  0.575364
8  0.585401
9  0.601073

Accuracy: 0.31217750257997934

Plotting Tree ....

Testing using dataset testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[  3  11  19   1  14   0   1   0   6   5]
 [ 21 268 225  36 107   7   5  11  20  20]
 [ 12 160 196 142 177   7  16   5  24  11]
 [ 11  89 106 120  76   4  15  12   8   9]
 [  3  94 102 142 267   3  13   9  20   7]
 [  0   0   0   9   6  26   1   2   7   9]
 [  2   7  10  11   6  10  11   5  20   8]
 [  0  11   7   4  15   1  16   4   2   0]
 [  1  24  47  13  18   2  12   2  23   8]
 [  0  29   9   1   5  18   1  11   9   7]]



               precision    recall  f1-score   support

           0       0.06      0.05      0.05        60
           1       0.39      0.37      0.38       720
           2       0.27      0.26      0.27       750
           3       0.25      0.27      0.26       450
           4       0.39      0.40      0.40       660
           5       0.33      0.43      0.38        60
           6       0.12      0.12      0.12        90
           7       0.07      0.07      0.07        60
           8       0.17      0.15      0.16       150
           9       0.08      0.08      0.08        90

    accuracy                           0.30      3090
   macro avg       0.21      0.22      0.22      3090
weighted avg       0.30      0.30      0.30      3090


    Average tpr  Average fpr
0     0.661166     0.650000
1     0.606892     0.542593
2     0.591880     0.579556
3     0.621338     0.577778
4     0.608505     0.531818
5     0.660946     0.522222
6     0.657778     0.625926
7     0.660396     0.644444
8     0.653515     0.615556
9     0.658111     0.640741

    ROC Area
0  0.516749
1  0.596449
2  0.518487
3  0.565341
4  0.615030
5  0.708086
6  0.547778
7  0.523927
8  0.556939
9  0.526056

Accuracy: 0.2993527508090615

Testing using 4000 moved testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[  2  26  41  31  30   3   3   3   8   2]
 [ 43 356 412 237 326  31  55  40 106  47]
 [ 34 377 386 259 325  29  69  52  84  46]
 [ 22 227 258 143 211  24  35  36  54  23]
 [ 31 357 368 187 244  36  69  43  89  53]
 [  2  29  38  19  26   3  11   4  10   4]
 [  4  43  53  31  58   8   9   4  24   5]
 [  6  39  37  18  29   1   6   5  12   8]
 [ 11  87  96  51  66   9  10   9  13  11]
 [  4  42  57  24  41   5   9   6  14   6]]



               precision    recall  f1-score   support

           0       0.01      0.01      0.01       149
           1       0.22      0.22      0.22      1653
           2       0.22      0.23      0.23      1661
           3       0.14      0.14      0.14      1033
           4       0.18      0.17      0.17      1477
           5       0.02      0.02      0.02       146
           6       0.03      0.04      0.03       239
           7       0.02      0.03      0.03       161
           8       0.03      0.04      0.03       363
           9       0.03      0.03      0.03       208

    accuracy                           0.16      7090
   macro avg       0.09      0.09      0.09      7090
weighted avg       0.17      0.16      0.17      7090


    Average tpr  Average fpr
0     0.659226     0.657534
1     0.592081     0.592771
2     0.583949     0.586619
3     0.619731     0.619187
4     0.601227     0.609249
5     0.659513     0.666667
6     0.653713     0.653061
7     0.657102     0.660215
8     0.647047     0.649956
9     0.656777     0.665109

    ROC Area
0  0.502538
1  0.498965
2  0.495995
3  0.500816
4  0.487966
5  0.489270
6  0.500978
7  0.495330
8  0.495637
9  0.487502

Accuracy: 0.16459802538787024

Testing using 9000 moved testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[  4  66  58  23  47   7   9  16   9  11]
 [ 87 538 604 453 519 112 124  74 157 109]
 [127 573 627 471 522  74  91  70 182 113]
 [ 57 375 404 293 319  37  61  45 100  67]
 [ 71 501 594 408 483  53  72  64 163 100]
 [  9  48  70  58  25   7  11   5  11   4]
 [ 12  84  90  64  89  11  19  16  26  18]
 [  4  52  63  52  65   2   8   8  17  11]
 [ 26 137 142 117  97  17  16  19  44  40]
 [ 19  62 102  36  61   4  10   4  18  16]]



               precision    recall  f1-score   support

           0       0.01      0.02      0.01       250
           1       0.22      0.19      0.21      2777
           2       0.23      0.22      0.22      2850
           3       0.15      0.17      0.16      1758
           4       0.22      0.19      0.20      2509
           5       0.02      0.03      0.02       248
           6       0.05      0.04      0.04       429
           7       0.02      0.03      0.03       282
           8       0.06      0.07      0.06       655
           9       0.03      0.05      0.04       332

    accuracy                           0.17     12090
   macro avg       0.10      0.10      0.10     12090
weighted avg       0.18      0.17      0.17     12090


    Average tpr  Average fpr
0     0.655085     0.660281
1     0.599168     0.600620
2     0.589851     0.593643
3     0.611654     0.615516
4     0.606770     0.599435
5     0.657799     0.654618
6     0.654976     0.657321
7     0.657823     0.657565
8     0.647023     0.639612
9     0.653106     0.655882

    ROC Area
0  0.492206
1  0.497822
2  0.494313
3  0.494207
4  0.511002
5  0.504771
6  0.496483
7  0.500386
8  0.511116
9  0.495836

Accuracy: 0.16865177832919767

Running Random Forrest Classifier ....

Cross Validation started ....
Start confusion matrix ....
Confusion Matrix:
 [[  29  155   22    0    4    0    0    0    0    0]
 [   0 1276  674  111  159    0    0    0    0    0]
 [   0  540 1151  271  286    0    2    0    0    0]
 [   0  136  304  671  296    0    0    0    2    1]
 [   3  267  454  272  975    9    0    0    0    0]
 [   0    9   49    4   35   47    8   12   30   16]
 [   0   53   22   51   49    0  142    3   31    9]
 [   0   30   40   31    6    1   15  101   16    0]
 [   0  119   73   64   16    8   28    3  207   22]
 [   0   27   64   27    2    1    7    4   17  121]]

               precision    recall  f1-score   support

           0       0.91      0.14      0.24       210
           1       0.49      0.57      0.53      2220
           2       0.40      0.51      0.45      2250
           3       0.45      0.48      0.46      1410
           4       0.53      0.49      0.51      1980
           5       0.71      0.22      0.34       210
           6       0.70      0.39      0.51       360
           7       0.82      0.42      0.56       240
           8       0.68      0.38      0.49       540
           9       0.72      0.45      0.55       270

    accuracy                           0.49      9690
   macro avg       0.64      0.41      0.46      9690
weighted avg       0.52      0.49      0.49      9690


    Average tpr  Average fpr
0     0.666561     0.620635
1     0.607050     0.475075
2     0.590412     0.496148
3     0.633213     0.508038
4     0.629788     0.502525
5     0.665999     0.592063
6     0.664523     0.535185
7     0.665891     0.526389
8     0.663169     0.538889
9     0.664968     0.517284

    ROC Area
0  0.568889
1  0.697963
2  0.641396
3  0.687762
4  0.690894
5  0.610903
6  0.694007
7  0.709253
8  0.686421
9  0.721526

Accuracy: 0.4871001031991744

Plotting Tree ....
Error: failed to send plot to http://127.0.0.1:63342
Traceback (most recent call last):
  File "C:\Program Files\JetBrains\PyCharm 2020.2.2\plugins\python\helpers\pycharm_display\datalore\display\display_.py", line 60, in _send_display_message
    urlopen(url, buffer)
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 222, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 531, in open
    response = meth(req, response)
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 640, in http_response
    response = self.parent.error(
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 569, in error
    return self._call_chain(*args)
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 502, in _call_chain
    result = func(*args)
  File "C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\urllib\request.py", line 649, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 500: Internal Server Error

Testing using a dataset testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[  0  32  16   2  10   0   0   0   0   0]
 [  0 430 220  19  51   0   0   0   0   0]
 [  0 163 305 162 120   0   0   0   0   0]
 [  0 120 107 154  68   0   1   0   0   0]
 [  0 131  83  71 375   0   0   0   0   0]
 [  0   0   1   0  32   7   0   2  14   4]
 [  0   4  25   2   0   3  19   3  30   4]
 [  0   5   7  15  14   0   1   4   1  13]
 [  0  40  14  25   4   0   6   0  59   2]
 [  0  19  27   0   0   0   0   0   8  36]]



               precision    recall  f1-score   support

           0       0.00      0.00      0.00        60
           1       0.46      0.60      0.52       720
           2       0.38      0.41      0.39       750
           3       0.34      0.34      0.34       450
           4       0.56      0.57      0.56       660
           5       0.70      0.12      0.20        60
           6       0.70      0.21      0.32        90
           7       0.44      0.07      0.12        60
           8       0.53      0.39      0.45       150
           9       0.61      0.40      0.48        90

    accuracy                           0.45      3090
   macro avg       0.47      0.31      0.34      3090
weighted avg       0.45      0.45      0.44      3090

C:\Users\euang\AppData\Local\Programs\Python\Python38\lib\site-packages\sklearn\metrics\_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

    Average tpr  Average fpr
0     0.500000     0.500000
1     0.594374     0.467593
2     0.595442     0.531111
3     0.629293     0.552593
4     0.625652     0.477273
5     0.666337     0.627778
6     0.665778     0.596296
7     0.666117     0.644444
8     0.660658     0.535556
9     0.664111     0.533333

    ROC Area
0  0.500000
1  0.690172
2  0.596496
3  0.615051
4  0.722568
5  0.557838
6  0.604222
7  0.532508
8  0.687653
9  0.696167

Accuracy: 0.4495145631067961

Testing using 4000 moved testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[  0  54  48   5  41   0   0   0   1   0]
 [  0 656 583  76 323   0   7   1   5   2]
 [  2 562 692  65 334   0   1   2   2   1]
 [  0 324 429  57 217   0   1   2   3   0]
 [  1 540 571  54 296   1   3   1   5   5]
 [  0  47  68   5  26   0   0   0   0   0]
 [  0  78  96  14  46   0   0   1   4   0]
 [  1  52  66   6  36   0   0   0   0   0]
 [  0 112 166  13  69   0   0   0   2   1]
 [  0  63  79  12  53   0   0   0   1   0]]



               precision    recall  f1-score   support

           0       0.00      0.00      0.00       149
           1       0.26      0.40      0.32      1653
           2       0.25      0.42      0.31      1661
           3       0.19      0.06      0.09      1033
           4       0.21      0.20      0.20      1477
           5       0.00      0.00      0.00       146
           6       0.00      0.00      0.00       239
           7       0.00      0.00      0.00       161
           8       0.09      0.01      0.01       363
           9       0.00      0.00      0.00       208

    accuracy                           0.24      7090
   macro avg       0.10      0.11      0.09      7090
weighted avg       0.19      0.24      0.20      7090


    Average tpr  Average fpr
0     0.666475     0.666667
1     0.554635     0.533534
2     0.535451     0.534050
3     0.652982     0.647805
4     0.599381     0.597185
5     0.666667     0.664399
6     0.666082     0.666667
7     0.666330     0.666667
8     0.665624     0.664908
9     0.666230     0.666667

    ROC Area
0  0.499712
1  0.531651
2  0.502101
3  0.507765
4  0.503294
5  0.503401
6  0.499123
7  0.499495
8  0.501074
9  0.499346

Accuracy: 0.24019746121297603

Testing using 9000 moved testing data ....

Starting ....

Starting Confusion Matrix ....

Confusion Matrix
 [[   0   90   88   21   47    1    0    1    2    0]
 [   2 1138  910  241  440   12    1    9   15    9]
 [  11 1150  921  215  504   14    7    4   12   12]
 [   2  708  567  135  322    5    4    2    7    6]
 [   2  971  894  230  373    6    3    5   14   11]
 [   0  107   56   43   38    2    2    0    0    0]
 [   1  170  124   64   60    2    1    1    4    2]
 [   0  113   95   31   39    1    0    0    2    1]
 [   1  290  186   63  109    2    0    2    1    1]
 [   1  106  134   32   57    0    0    1    0    1]]



               precision    recall  f1-score   support

           0       0.00      0.00      0.00       250
           1       0.23      0.41      0.30      2777
           2       0.23      0.32      0.27      2850
           3       0.13      0.08      0.10      1758
           4       0.19      0.15      0.17      2509
           5       0.04      0.01      0.01       248
           6       0.06      0.00      0.00       429
           7       0.00      0.00      0.00       282
           8       0.02      0.00      0.00       655
           9       0.02      0.00      0.01       332

    accuracy                           0.21     12090
   macro avg       0.09      0.10      0.09     12090
weighted avg       0.17      0.21      0.18     12090


    Average tpr  Average fpr
0     0.666103     0.666667
1     0.534180     0.529685
2     0.556766     0.558076
3     0.636548     0.639855
4     0.611522     0.613016
5     0.665400     0.666667
6     0.666152     0.666667
7     0.666073     0.662116
8     0.665151     0.664114
9     0.665475     0.665686

    ROC Area
0  0.499155
1  0.506742
2  0.498035
3  0.495039
4  0.497758
5  0.498100
6  0.499228
7  0.505936
8  0.501555
9  0.499683

Accuracy: 0.21273779983457403

Process finished with exit code 0
